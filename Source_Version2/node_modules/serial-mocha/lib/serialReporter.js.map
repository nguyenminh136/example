{"version":3,"sources":["lib/serialReporter.js"],"names":[],"mappings":"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","file":"lib/serialReporter.js","sourcesContent":["/**\n * module serialReporter\n *\n */\n'use strict';\nlet fixTest = (test)=> {\n\tlet include = [\"title\",\n\t\t\"async\",\n\t\t\"sync\",\n\t\t\"timedOut\",\n\t\t\"pending\",\n\t\t\"type\",\n\t\t\"file\",\n\t\t\"duration\"\n\t];\n\n\ttry {\n\t\tlet o = {};\n\t\tfor (let prop in test) {\n\n\t\t\tif (include.indexOf(prop) !== -1) {\n\t\t\t\to[prop] = test[prop];\n\t\t\t}\n\t\t}\n\t\to.status = test.state;\n\t\treturn o;\n\t} catch (ex) {\n\t\tconsole.log(ex, ex.stack);\n\t}\n}\nlet findTheSuite = (suiteName, theSuite)=> {\n\ttry {\n\t\tlet foundValue = null;\n\t\tif (suiteName === theSuite.suite) {\n\t\t\tfoundValue = theSuite;\n\t\t}\n\t\telse {\n\t\t\tif (theSuite.suites) {\n\t\t\t\ttheSuite.suites.forEach((value, key)=> {\n\t\t\t\t\t//console.log(key,\"in find the suite\");\n\t\t\t\t\tif (!foundValue) {\n\t\t\t\t\t\tfoundValue = findTheSuite(suiteName, value);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\treturn foundValue;\n\t} catch (ex) {\n\t\tconsole.log(ex, ex.stack);\n\t}\n}\nclass Reporter {\n\tconstructor(runner) {\n\n\t\tlet currentSuite = null;\n\t\tlet parentSuite = null;\n\t\tlet out = {file: null, suites: []};\n\t\trunner.on(\"suite\", (suite)=> {\n\t\t\tif (suite.root) {\n\t\t\t\tsuite.suites.forEach((item)=> {\n\t\t\t\t\tout.suites.push({suite: item.title, suites: [], tests: []});\n\t\t\t\t\tout.file = item.file;\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (!suite.root) {\n\t\t\t\tparentSuite = currentSuite;\n\t\t\t\tif (parentSuite && !(parentSuite === 'rootSuite')) {\n\t\t\t\t\tlet _temp = findTheSuite(suite.title, out);\n\t\t\t\t\tif (!_temp) {\n\t\t\t\t\t\tlet _parent = findTheSuite(parentSuite, out);\n\t\t\t\t\t\tif (_parent) {\n\t\t\t\t\t\t\t_parent.suites.push({suite: suite.title, suites: [], tests: []})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcurrentSuite = suite.title || \"rootSuite\";\n\t\t});\n\t\trunner.on(\"pending\", (test)=> {\n\t\t\tlet found = findTheSuite(currentSuite, out);\n\t\t\t//console.log(\"foundthesuite\",found ===null,found instanceof Map);\n\t\t\tif (found && found.tests) {\n\t\t\t\tfound.tests.push({test: fixTest(test), error: null});\n\t\t\t}\n\t\t});\n\t\trunner.on(\"pass\", (test)=> {\n\t\t\tlet found = findTheSuite(currentSuite, out);\n\t\t\tif (found && found.tests) {\n\t\t\t\tfound.tests.push({test: fixTest(test), error: null});\n\t\t\t}\n\t\t});\n\t\trunner.on(\"fail\", (test, err)=> {\n\t\t\tlet found = findTheSuite(currentSuite, out);\n\t\t\tif (found && found.tests) {\n\t\t\t\tfound.tests.push({test: fixTest(test), error: err.message});\n\t\t\t}\n\t\t});\n\t\trunner.on(\"end\", ()=> {\n\t\t\tif (process.send) {\n\t\t\t\tprocess.send({type: \"mochaDone\", message: JSON.stringify(out)})\n\t\t\t}\n\t\t});\n\t}\n}\nmodule.exports = Reporter;"],"sourceRoot":"/source/"}